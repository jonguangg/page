<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta name="page-view-size" content="1280*720">
		<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
		<title>专题专区</title> 
<style type="text/css">
td{
    FONT-SIZE: 20px; LINE-HEIGHT: 30px;text-align:center;vertical-align:middle;color:#ffffff
}
.zoneImg{
width:177px; height:224px; position:absolute; top: 449px; -webkit-transition-duration:400ms;
}
</style>
<!--<script>
//设置默认按钮
iPanel.focus.borders= 0;
iPanel.focus.defaultFocusColor ="#FFCC00";
iPanel.defaultFocusColor="#FFCC00";  //颜色
</script>-->
<script type=text/javascript src="../global.js"></script>
<script type="text/javascript">
var area = 0;
var menuPos = 0;
var menusPos= 0;
var zone_ListPos = parseInt(getCookie("zone_ListPos"))?parseInt(getCookie("zone_ListPos")):0;
var hiddenList = parseInt(getCookie("hiddenList"))?parseInt(getCookie("hiddenList")):0;
var changePos=0;
var topPos=0;
var listSize = 5; //条目数
var url = window.location.href;
var wordSize = 10;
var scrollPos=0;
var curIndex=0;
var length=10; 
var zoneFocusLeft = 97;

function $(id){return document.getElementById(id);}

var listArray=[//百事通专区
	{nums:"1",title:"速度与激情1",url:"../paihang/paihang1.htm",img:"url(0.png)"},
	{nums:"2",title:"速度与激情2",url:"../paihang/paihang2.htm",img:"url(1.png)"},
	{nums:"3",title:"速度与激情3",url:"../paihang/paihang3.htm",img:"url(2.png)"},
	{nums:"4",title:"速度与激情4",url:"../paihang/paihang4.htm",img:"url(3.png)"},
	{nums:"5",title:"速度与激情5",url:"../paihang/paihang5.htm",img:"url(4.png)"},
	{nums:"6",title:"速度与激情6",url:"../paihang/paihang6.htm",img:"url(5.png)"},
	{nums:"7",title:"速度与激情7",url:"../paihang/paihang7.htm",img:"url(6.png)"}
	]

function showList(){
	focusImg("list");
	for(i=0; i<listArray.length; i++){
			$("zoneImg"+i).style.left =  157+(i-hiddenList)*197+"px";
			if($("zoneImg"+i).style.left < 157 || $("zoneImg"+i).style.left > 945){
				$("zoneImg"+i).style.backgroundImage = "url()";
			}else $("zoneImg"+i).style.backgroundImage = "url("+i+".png)";
	}	
}

function listFocus(__num){
	zone_ListPos+=__num;
	
	if(zone_ListPos<0){
		zone_ListPos=0;
	}else if(zone_ListPos>listArray.length-1){
			zone_ListPos = listArray.length-1;
	}
	
	if(__num>0 && zone_ListPos>4 && zone_ListPos<listArray.length){
		hiddenList++;
		if(hiddenList>listArray.length-5){
			hiddenList=listArray.length-5;
			}
		showList();
	}else if(__num<0 && zone_ListPos<2 && hiddenList>0){
		hiddenList--;
		showList();		
	}

//	zoneFocusLeft = ((zone_ListPos-hiddenList)%5)*197+157;
//	$("zoneFocus").style.left = zoneFocusLeft+'px';
	$("zoneFocus").style.left = ((zone_ListPos-hiddenList)%5)*197+157+'px';
	
}

function focusImg(areas){
	if(areas=="list"){
		$("zoneFocus").style.backgroundImage = "url(../img/zoneFocus0.png)";
		$("zoneFocus").style.left =((zone_ListPos-hiddenList)%5)*197+157+"px";
		$("zoneFocus").style.top = "449px";
	}else {
		$("zoneFocus").style.backgroundImage = "url(../img/focusPage.png)";
		$("zoneFocus").style.left = $(areas).style.left;
		$("zoneFocus").style.top = $(areas).style.top;
	}
}

function pageUp(){
	zone_ListPos-=listSize;
	if(zone_ListPos<0){
		zone_ListPos+=listSize;	
	}
	posArray[menuPos] = zone_ListPos;
	showList();
}

function pageDown(){
	zone_ListPos+=listSize;
		if(zone_ListPos>listArray.length-1){
		if(parseInt(zone_ListPos/listSize)!=parseInt((listArray.length-1+listSize)/listSize))zone_ListPos = listArray.length-1;
		else zone_ListPos-=listSize;
	}
//	posArray[menuPos] = zone_ListPos;
	showList();
}


//页码
function pageNum(){
//	zone_ListPos = posArray[menuPos];
	var currPage = parseInt((zone_ListPos+listSize)/listSize);//当前第几页
	var allPage = parseInt((listArray.length-1+listSize)/listSize);//总共多少页
	$("page").innerHTML = "第"+currPage+"页"+"/"+"共"+allPage+"页"; 
}

//Cookie
function setCookie(name, value){
  var exp = new Date(); 
  exp.setTime(exp.getTime() + (1*2*60*1000));//小时*分钟*秒*毫秒
  window.document.cookie = name + "=" + escape (value) + "; expires=" + exp.toGMTString();
}

function delCookie(name){ 
  var exp = new Date(); 
  exp.setTime(exp.getTime() -1000);
  window.document.cookie = name + "= null; expires=" + exp.toGMTString();
}

function getCookie(sName){
  var aCookie = document.cookie.split("; ");
  for (var i=0; i < aCookie.length; i++)
  {
    var aCrumb = aCookie[i].split("=");
    if (sName == aCrumb[0]){
      return unescape(aCrumb[1]);
    }
  }
  return null;
}

function doSelect(){
	if(area==0)	{
		setCookie("zone_ListPos", zone_ListPos);
		setCookie("hiddenList", hiddenList);
		location.href = listArray[zone_ListPos].url;
	}else if(area==1){
		history.go(-1);
		setCookie("zone_ListPos", zone_ListPos);
		setCookie("hiddenList", hiddenList);
	}else if(area==2){
		location.href = "../index.htm";
		setCookie("zone_ListPos", zone_ListPos);
		setCookie("hiddenList", hiddenList);
	}else if(area==3){
		location.href = "shouye.htm";
		setCookie("zone_ListPos", zone_ListPos);
		setCookie("hiddenList", hiddenList);
	}
}

//遥控键值
document.onsystemevent = grabEvent;
document.onkeypress = grabEvent;
document.onirkeypress=grabEvent;
function grabEvent(){
	var currPage = parseInt((listPos+listSize)/listSize);//当前第几页
	var key_code = event.which;
	switch(key_code){
		case 1://上
//			area=0;
//			focusImg("list");
			return 0;
			break;

		case 2://下
//			area=1;
//			focusImg("pageBack");
			return 0;
			break;
						
		case 3://左
			if(area==0){
				listFocus(-1);
			}/*
			else if(area==1){
				area=2;
				focusImg("pageZhu");
			}else if(area==2){
				area=3;
				focusImg("pageShou");
			}*/
			return 0;
			break;
			
		case 4: //右
			if(area==0){
				listFocus(1);
			}/*
			else if(area==3){
				area=2;
				focusImg("pageZhu");
			}else if(area==2){
				area=1;
				focusImg("pageBack");
			}*/
			return 0;
			break;	
			
		case 13: //enter
			doSelect();
		    return 0;
			break;

		case 340: //back
			location.href = "../index.htm";
//			history.go(-1);
			return 0;
			break;				
	}
}

//电脑键值,上线后需删除此段代码
function eventHandler(e,type){
	var key_code = e.code;
	switch(key_code){
		case "KEY_UP"://上
//			area=0;
//			focusImg("list");
			return 0;
			break;

		case "KEY_DOWN"://下
//			area=1;
//			focusImg("pageBack");
			return 0;
			break;
						
		case "KEY_LEFT"://左
			if(area==0){
				listFocus(-1);
			}/*
			else if(area==1){
				area=2;
				focusImg("pageZhu");
			}else if(area==2){
				area=3;
				focusImg("pageShou");
			}*/
			return 0;
			break;
			
		case "KEY_RIGHT": //右
			if(area==0){
				listFocus(1);
			}/*
			else if(area==3){
				area=2;
				focusImg("pageZhu");
			}else if(area==2){
				area=1;
				focusImg("pageBack");
			}*/
			return 0;
			break;	
			
		case "KEY_SELECT": //enter
			doSelect();
		    return 0;
			break;

		case "KEY_BACK": //back
		    delCookie("zone_ListPos");
			delCookie("hiddenList");
			location.href = "../index.htm";
			return 0;
			break;				
	}
}

function init(){
	showList();
	focusImg("list");
}
</script>

</head>
<body topmargin="0" leftmargin="0" style=" background:url(../img/index_zone.png); overflow:hidden;" onload="init();">

 <div id="zoneImg0" class="zoneImg" style="left: 157px;background: url('0.png')"> </div>
 <div id="zoneImg1" class="zoneImg" style="left: 354px;background: url('1.png')"> </div>
 <div id="zoneImg2" class="zoneImg" style="left: 551px;background: url('2.png')"> </div>
 <div id="zoneImg3" class="zoneImg" style="left: 748px;background: url('3.png')"> </div>
 <div id="zoneImg4" class="zoneImg" style="left: 945px;background: url('4.png')"> </div>
 <div id="zoneImg5" class="zoneImg" style="left: 1142px;background: url('5.png')"> </div>
 <div id="zoneImg6" class="zoneImg" style="left: 1339px;background: url('6.png')"> </div>
 <div id="zoneImg7" class="zoneImg" style="left: 1536px;background: url('7.png')"> </div>

<div id="index_zone_left" style="z-index: 1; position: absolute; left: 0px; top: 449px; width: 157px; height: 224px; background: url('../img/index_zone_left.png') no-repeat"></div>

<div id="index_zone_right" style="z-index: 1; position: absolute; left: 1122px; top: 449px; width: 158px; height: 224px; background: url('../img/index_zone_right.png') no-repeat"></div>

<div id="zoneFocus" style="z-index: 1; background:url() no-repeat; position:absolute; left:157px; top:449px; width:177px; height:224px; -webkit-transition-duration:400ms;"> </div>

</body>
</html>