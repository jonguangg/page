<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta name="page-view-size" content="1280*720">
		<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
		<title>百事通专区</title> 
<style type="text/css">
td{
    FONT-SIZE: 20px;text-align:center;vertical-align:middle;color:#ffffff
}
</style>
<!--<script>
//设置默认按钮
iPanel.focus.borders= 0;
iPanel.focus.defaultFocusColor ="#FFCC00";
iPanel.defaultFocusColor="#FFCC00";  //颜色
</script>-->
<script type=text/javascript src="../global.js"></script>
<script type="text/javascript">
var area = 0;
var menuPos = 0;
var menusPos= 0;
var BST_ListPos = parseInt(getCookie("BST_ListPos"))?parseInt(getCookie("BST_ListPos")):0;
var changePos=0;
var topPos=0;
var listSize = 10; //条目数
var url = window.location.href;
var wordSize = 9;
var curIndex=0;
var length=10; 
var zoneFocusLeft = 97;
var zoneFocusTop = 117;

function $(id){return document.getElementById(id);}

var listArray=[//百事通专区
	{nums:"1",title:"匆匆那年",url:"../paihang/paihang1.htm"},
	{nums:"2",title:"超能陆战队（中文配音）",url:"../paihang/paihang2.htm"},
	{nums:"3",title:"大喜临门",url:"../paihang/paihang3.htm"},
	{nums:"4",title:"地牢围攻3",url:"../paihang/paihang4.htm"},
	{nums:"5",title:"第七谎言",url:"../paihang/paihang5.htm"},
	{nums:"6",title:"定制伴郎定制伴郎定制伴郎",url:"../paihang/paihang6.htm"},
	{nums:"7",title:"飓风营救3",url:"../paihang/paihang7.htm"},
	{nums:"8",title:"魔法黑森林",url:"../paihang/paihang8.htm"},
	{nums:"9",title:"魔法之家",url:"../paihang/paihang9.htm"},
	{nums:"10",title:"陌路惊笑",url:"../paihang/paihang10.htm"},
	{nums:"11",title:"奇鞋妙旅",url:"../paihang/paihang11.htm"},
	{nums:"12",title:"善意杀戮",url:"../paihang/paihang12.htm"},
	{nums:"13",title:"失孤",url:"../paihang/paihang13.htm"},
	{nums:"14",title:"十万伙急",url:"../paihang/paihang14.htm"},
	{nums:"15",title:"万物生长",url:"../paihang/paihang15.htm"},
	{nums:"16",title:"我是女王",url:"../paihang/paihang16.htm"},
	{nums:"17",title:"喜羊羊与灰太狼之羊年喜羊羊",url:"../paihang/paihang17.htm"},
	{nums:"18",title:"熊出没之雪岭熊风",url:"../paihang/paihang18.htm"},
	{nums:"19",title:"业内前五",url:"../paihang/paihang19.htm"},
	{nums:"20",title:"咱们结婚吧",url:"../paihang/paihang20.htm"},
	{nums:"21",title:"政治之爱",url:"../paihang/paihang21.htm"},
	{nums:"22",title:"左耳",url:"../paihang/paihang22.htm"},
	{nums:"23",title:"23",url:"../paihang/paihang23.htm"},
	{nums:"24",title:"24",url:"../paihang/paihang24.htm"},
	{nums:"25",title:"25",url:"../paihang/paihang25.htm"},
	{nums:"26",title:"26",url:"../paihang/paihang26.htm"},
	{nums:"27",title:"27",url:"../paihang/paihang27.htm"},
	{nums:"28",title:"28",url:"../paihang/paihang28.htm"},
	{nums:"29",title:"29",url:"../paihang/paihang29.htm"},
	{nums:"30",title:"30",url:"../paihang/paihang30.htm"}
];

function showList(){
	var currPage = parseInt((BST_ListPos+listSize)/listSize);//当前第几页
	var allPage = parseInt((listArray.length-1+listSize)/listSize);//总共多少页
	var position = (parseInt((BST_ListPos+listSize)/listSize)-1)*listSize; //当前页的第一个	
	for(i=0; i<listSize; i++){
		if(position+i<listArray.length){
			$("zoneImg"+i).style.backgroundImage =  "url('../baiShiTong/"+(position+i)+".png')";
			$("zoneTxt"+i).innerHTML = listArray[position+i].title.slice(0,wordSize);
			$("zoneTxt"+i).style.color = "white";
		}
		else {
			$("zoneImg"+i).style.backgroundImage = "url('../zone/99.png')";
			$("zoneTxt"+i).innerHTML = "";
		}
	}

	if(currPage==1 && currPage==allPage){
		$("pageUp").style.backgroundImage = "url()";
		$("pageDown").style.backgroundImage = "url()";
	}else if(currPage==1 && currPage<allPage){
		$("pageUp").style.backgroundImage = "url()";
		$("pageDown").style.backgroundImage = "url(../img/pageDown.png)";		
	}else if(currPage>1 && currPage<allPage){
		$("pageUp").style.backgroundImage = "url(../img/pageUp.png)";
		$("pageDown").style.backgroundImage = "url(../img/pageDown.png)";		
	}else if(currPage>1 && currPage==allPage){
		$("pageUp").style.backgroundImage = "url(../img/pageUp.png)";	
		$("pageDown").style.backgroundImage = "url()";	
	}
	pageNum();
	listFocus(0);
}

function listFocus(__num){
	var currPage = parseInt((BST_ListPos+listSize)/listSize);//当前第几页	
	$("zoneTxt"+BST_ListPos%listSize).innerHTML = listArray[BST_ListPos].title.slice(0,wordSize);
	$("zoneTxt"+BST_ListPos%listSize).style.color = "white";
	
	var tempPos = BST_ListPos;
	BST_ListPos+=__num;

	if(BST_ListPos<0){ //焦点定位到当前页第一个
	   BST_ListPos=10*(currPage-1)
	}
			
	else if(BST_ListPos>listArray.length-1)
		{
		BST_ListPos = tempPos;
		listFocus(0);
		return;
		}
	//如果翻了页，条目重新输出
	if(parseInt((BST_ListPos+listSize)/listSize)!=parseInt((tempPos+listSize)/listSize))
	showList();
/*	{
		if(__num<0)
		{showList();
		}
		else{
			BST_ListPos = tempPos;
			listFocus(0);
			return;
		     }
	}*/

	zoneFocusLeft = (BST_ListPos%5)*220+97;
	if((BST_ListPos%listSize)<5){
		zoneFocusTop=117;
		}
	else zoneFocusTop=389;

	$("zoneFocus").style.left = zoneFocusLeft+'px';
	$("zoneFocus").style.top = zoneFocusTop+'px';
	$("zoneTxt"+BST_ListPos%listSize).style.color = "#ffcc00";
	
	if(listArray[BST_ListPos].title.length>wordSize)
	{
		$("zoneTxt"+BST_ListPos%listSize).innerHTML = '<marquee direction="left" width="88%" scrollamonut="15" scrolldelay="100">'+listArray[BST_ListPos].title +'</marquee>';
	}
}

function pageUp(){
	BST_ListPos-=listSize;
	if(BST_ListPos<0){
		BST_ListPos+=listSize;	
	}
	showList();
	listFocus(-100);
	setCookie("BST_ListPos", BST_ListPos);
}

function pageDown(){
	BST_ListPos+=listSize;
		if(BST_ListPos>listArray.length-1){
		if(parseInt(BST_ListPos/listSize)!=parseInt((listArray.length-1+listSize)/listSize))BST_ListPos = listArray.length-1;
		else BST_ListPos-=listSize;
	}
	showList();
	listFocus(-100);
	setCookie("BST_ListPos", BST_ListPos);
}

function focusImg(areas){
	if(areas=="null"){
		$("focusBg").style.backgroundImage = "url()";
	}else {
		$("focusBg").style.backgroundImage = "url(../img/focusPage.png)";
		$("focusBg").style.left = $(areas).style.left;
		$("focusBg").style.top = $(areas).style.top;
	}
}

//页码
function pageNum(){
	var currPage = parseInt((BST_ListPos+listSize)/listSize);//当前第几页
	var allPage = parseInt((listArray.length-1+listSize)/listSize);//总共多少页
	$("page").innerHTML = currPage+"/"+allPage+"页"; 
}

//Cookie
function setCookie(name, value){
  var exp = new Date(); 
  exp.setTime(exp.getTime() + (1*2*60*1000));//小时*分钟*秒*毫秒
  window.document.cookie = name + "=" + escape (value) + "; expires=" + exp.toGMTString();
//  window.document.cookie = name + "=" + escape (value);
}

function delCookie(name){ 
  var exp = new Date(); 
  exp.setTime(exp.getTime() -1000);
  window.document.cookie = name + "= null; expires=" + exp.toGMTString();
}

function getCookie(sName){
  var aCookie = document.cookie.split("; ");
  for (var i=0; i < aCookie.length; i++)
  {
    var aCrumb = aCookie[i].split("=");
    if (sName == aCrumb[0]){
      return unescape(aCrumb[1]);
    }
  }
  return null;
}

function doSelect(){
	var currPage = parseInt((BST_ListPos+listSize)/listSize);//当前第几页
	var allPage = parseInt((listArray.length-1+listSize)/listSize);//总共多少页	
	if(area==0)	{
		setCookie("BST_ListPos", BST_ListPos);
		location.href = listArray[BST_ListPos].url;
	}/*else if(area==1){
		pageDown();
		if(currPage==allPage-1){
		  area=2;	
		  focusImg("pageUp");	
		}
	}else if(area==2){
    	pageUp();	
		if(currPage==2){
			area=1;	
			focusImg("pageDown");
		}
	}else if(area==3){
		history.go(-1);
	}else if(area==4){
	    location.href = "zhuye.htm";
	}else if(area==5){
		location.href = "shouye.htm";
	}*/
}

document.onsystemevent = grabEvent;
document.onkeypress = grabEvent;
document.onirkeypress=grabEvent;
function grabEvent(){
	var currPage = parseInt((BST_ListPos+listSize)/listSize);//当前第几页
	var allPage = parseInt((listArray.length-1+listSize)/listSize);//总共多少页	
	var key_code = event.which;
//	alert(key_code);
	switch(key_code){
		case 1://up
		if(area==0 && BST_ListPos-10*(currPage-1)>4){
			listFocus(-5);				
		 }/*
	    else{
			area=0;
			listFocus(0);
			focusImg("null");
			$("zoneFocus").style.backgroundImage = "url(../img/zoneFocus.png)";			 						
		}*/
		return 0;
		break;	

		case 2://down
		  if(area==0 && (BST_ListPos-10*(currPage-1))<5 && (BST_ListPos+5) < listArray.length){//焦点在上可下移
			 listFocus(5);
		  }
	/*	 else if(area==0 && (BST_ListPos-10*(currPage-1))<5 && (BST_ListPos+6) > listArray.length && currPage == allPage && allPage>1){//焦点在上,不可下移,最后一页
			  area=2;	
			  showList();
			  focusImg("pageUp");		  
			  $("zoneFocus").style.backgroundImage = "url()";			  
		   }
		  else if(area==0 && (BST_ListPos-10*(currPage-1))<5 && (BST_ListPos+6) > listArray.length && currPage < allPage && allPage>1){//非最后一页
			  area=1;
			  showList();
			  focusImg("pageDown");	
			  $("zoneFocus").style.backgroundImage = "url()";		  
		  }
		  else if(area==0 && (BST_ListPos-10*(currPage-1)) > 4 && currPage==allPage && allPage>1){//焦点在下,最后一页
			  area=2;
			  showList();
			  focusImg("pageUp");
			  $("zoneFocus").style.backgroundImage = "url()";	  	  
		   }
		  else if(area==0 && (BST_ListPos-10*(currPage-1)) > 4 && currPage < allPage && allPage>1){//焦点在下,非最后一页{
			  area=1;
			  showList();
			  focusImg("pageDown");	
			  $("zoneFocus").style.backgroundImage = "url()"; 
		   }
		   else if(area==0 && allPage==1){
			   area=3;
			   showList();
			   focusImg("pageBack");
			   $("zoneFocus").style.backgroundImage = "url()"; 
		   }*/
			return 0;
			break;	
        
		case 3://left
			if(area==0){
				listFocus(-1);
			}/*else if(area==1 && currPage>1)
			{
			  area=2;
			  focusImg("pageUp");			  
			}*/
			return 0;
			break; 
					  				
		case 4: //right
			if(area==0 && BST_ListPos<listArray.length-1){
				listFocus(1);
			}/*else if(area==2 && currPage<allPage)
			{
			    area=1;
				focusImg("pageDown");			
			}else if(area==3 && currPage ==1 && allPage>1){
				area=1;
				focusImg("pageDown");
			}else if(area==3 && currPage >1 && allPage>1){
				area=2;
				focusImg("pageUp");
			}else if(area==4){
				area=3;
				focusImg("pageBack");
			}else if(area==5){
				area=4;
				focusImg("pageZhu");
				}*/
			return 0;
			break;	
			
		case 373://P+下一页
		    if(area==0 && currPage<allPage){
			pageDown();			
			}

		    return 0;
			break;
			
		case 372://P-上一页
			if(area==0 && currPage>1){
			pageUp();
			}
			return 0;
			break;	
						
		case 13: //enter
			doSelect();
		    return 0;
			break;

		case 340: //back
			history.go(-1);
			break;	
			
		case 339://exit
			window.close();
			return 0;
			break;
	}
}

//电脑键值，上线后需删掉
function eventHandler(e,type){
	var currPage = parseInt((BST_ListPos+listSize)/listSize);//当前第几页
	var allPage = parseInt((listArray.length-1+listSize)/listSize);//总共多少页	
	var key_code = e.code;
//	alert(key_code);
	switch(key_code){
		case "KEY_UP"://up
		if(area==0 && BST_ListPos-10*(currPage-1)>4){
			listFocus(-5);				
		 }/*
	    else{
			area=0;
			listFocus(0);
			focusImg("null");
			$("zoneFocus").style.backgroundImage = "url(../img/zoneFocus.png)";			 						
		}*/
		return 0;
		break;	

		case "KEY_DOWN"://down
		  if(area==0 && (BST_ListPos-10*(currPage-1))<5 && (BST_ListPos+5) < listArray.length){//焦点在上可下移
			 listFocus(5);
		  }
	/*	 else if(area==0 && (BST_ListPos-10*(currPage-1))<5 && (BST_ListPos+6) > listArray.length && currPage == allPage && allPage>1){//焦点在上,不可下移,最后一页
			  area=2;	
			  showList();
			  focusImg("pageUp");		  
			  $("zoneFocus").style.backgroundImage = "url()";			  
		   }
		  else if(area==0 && (BST_ListPos-10*(currPage-1))<5 && (BST_ListPos+6) > listArray.length && currPage < allPage && allPage>1){//非最后一页
			  area=1;
			  showList();
			  focusImg("pageDown");	
			  $("zoneFocus").style.backgroundImage = "url()";		  
		  }
		  else if(area==0 && (BST_ListPos-10*(currPage-1)) > 4 && currPage==allPage && allPage>1){//焦点在下,最后一页
			  area=2;
			  showList();
			  focusImg("pageUp");
			  $("zoneFocus").style.backgroundImage = "url()";	  	  
		   }
		  else if(area==0 && (BST_ListPos-10*(currPage-1)) > 4 && currPage < allPage && allPage>1){//焦点在下,非最后一页{
			  area=1;
			  showList();
			  focusImg("pageDown");	
			  $("zoneFocus").style.backgroundImage = "url()"; 
		   }
		   else if(area==0 && allPage==1){
			   area=3;
			   showList();
			   focusImg("pageBack");
			   $("zoneFocus").style.backgroundImage = "url()"; 
		   }*/
			return 0;
			break;	
        
		case "KEY_LEFT"://left
			if(area==0){
				listFocus(-1);
			}/*else if(area==1 && currPage>1)
			{
			  area=2;
			  focusImg("pageUp");			  
			}*/
			return 0;
			break; 
					  				
		case "KEY_RIGHT": //right
			if(area==0 && BST_ListPos<listArray.length-1){
				listFocus(1);
			}/*else if(area==2 && currPage<allPage)
			{
			    area=1;
				focusImg("pageDown");			
			}else if(area==3 && currPage ==1 && allPage>1){
				area=1;
				focusImg("pageDown");
			}else if(area==3 && currPage >1 && allPage>1){
				area=2;
				focusImg("pageUp");
			}else if(area==4){
				area=3;
				focusImg("pageBack");
			}else if(area==5){
				area=4;
				focusImg("pageZhu");
				}*/
			return 0;
			break;	
			
		case "PAGE_DOWN"://P+下一页
		    if(area==0 && currPage<allPage){
			pageDown();			
			}

		    return 0;
			break;
			
		case "PAGE_UP"://P-上一页
			if(area==0 && currPage>1){
			pageUp();
			}
			return 0;
			break;	
						
		case "KEY_SELECT": //enter
			doSelect();
		    return 0;
			break;

		case "KEY_BACK": //back
//			history.go(-1);
			location.href = "../index.htm";
			delCookie("BST_ListPos");
			break;	
			
		case "KEY_EXIT"://exit
			window.close();
			return 0;
			break;
	}
}

function init(){
	showList();
}
</script>

</head>
<body topmargin="0" leftmargin="0" style="background:url(../img/index_baiShiTong.png)" onload="init();">
 <div style="position:absolute; left: 100px; top: 120px; width:1080px; height:524px"> 
    <table  width="1080" border="0" cellpadding="0" cellspacing="0" >
			<tr>
				<td id="zoneImg0" width="200" height="222"></td>
				<td width="20" height="222"></td>
				<td id="zoneImg1" width="200" height="222"></td>
			    <td width="20" height="222"></td>
				<td id="zoneImg2" width="200" height="222"></td>
			    <td width="20" height="222"></td>
				<td id="zoneImg3" width="200" height="222"></td>
				<td width="20" height="222"></td>
				<td id="zoneImg4" width="200" height="222"></td>
			</tr>
			<tr>
				<td id="zoneTxt0" width="200" height="30" >&nbsp;</td>
				<td width="20" height="30"></td>
				<td id="zoneTxt1" width="200" height="30">&nbsp;</td>
			    <td  width="20" height="30"></td>
				<td id="zoneTxt2" width="200" height="30">&nbsp;</td>
			    <td width="20" height="30"></td>
				<td id="zoneTxt3" width="200" height="30">&nbsp;</td>
				<td width="20" height="30"></td>
				<td id="zoneTxt4" width="200" height="30">&nbsp;</td>
			</tr>
			<tr>
				<td width="200" height="20"></td>
				<td height="20"></td>
				<td width="200" height="20"></td>
			    <td height="20"></td>
				<td width="200" height="20"></td>
			    <td height="20"></td>
				<td width="200" height="20"></td>
				<td height="20"></td>
				<td width="200" height="20"></td>
			</tr>
			<tr>
				<td id="zoneImg5" width="200" height="222"></td>
				<td width="20" height="222"></td>
				<td id="zoneImg6" width="200" height="222"></td>
			    <td width="20" height="222"></td>
				<td id="zoneImg7" width="200" height="222"></td>
			    <td width="20" height="222"></td>
				<td id="zoneImg8" width="200" height="222"></td>
				<td width="20" height="222"></td>
				<td id="zoneImg9" width="200" height="222"></td>
			</tr>
			<tr>
				<td id="zoneTxt5" width="200" height="30">&nbsp;</td>
				<td width="16" height="30"></td>
				<td id="zoneTxt6" width="200" height="30">&nbsp;</td>
			    <td width="16" height="30"></td>
				<td id="zoneTxt7" width="200" height="30">&nbsp;</td>
			    <td width="15" height="30"></td>
				<td id="zoneTxt8" width="200" height="30">&nbsp;</td>
				<td width="16" height="30"></td>
				<td id="zoneTxt9" width="200" height="30">&nbsp;</td>
			</tr>
  </table>
</div>

<div id="zoneFocus" style="background-image:url(../img/zoneFocus.png); position:absolute; left:97px; top:117px; width:206px; height:258px;-webkit-transition-duration: 100ms;"> </div>

<div id="page" style="position: absolute; left: 777px; top: 660px; width: 122px; height: 40px; text-align: center; line-height: 40px; color: #000000; font-size: 25px;">1/3</div>

<div id="pageUp" style="z-index: 100; position: absolute; left: 904px; top: 658px; width: 130px; height: 40px; line-height: 36px; background: url() no-repeat"></div>

<div id="pageDown" style="z-index: 100; position: absolute; left: 1048px; top: 658px; width: 130px; height: 40px; line-height: 36px; background: url('../img/pageDown.png') no-repeat""></div>

<div id="focusBg" style="z-index: 100; position: absolute; left: 1060px; top: 658px; width: 110px; height: 40px; line-height: 36px; background: url() no-repeat"></div>
</body>
</html>