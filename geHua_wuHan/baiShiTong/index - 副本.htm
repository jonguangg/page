<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta name="page-view-size" content="1280*720">
		<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
		<title>百事通专区</title> 
<style type="text/css">
td{
    FONT-SIZE: 20px;text-align:center;vertical-align:middle;color:#ffffff
}
</style>
<!--<script>
//设置默认按钮
iPanel.focus.borders= 0;
iPanel.focus.defaultFocusColor ="#FFCC00";
iPanel.defaultFocusColor="#FFCC00";  //颜色
</script>-->
<script type="text/javascript">
var area = 0;
var menuPos = 0;
var menusPos= 0;
var listPos = 5;  //条目当前位置
var changePos=0;
var topPos=0;
var listSize = 10; //条目数
var url = window.location.href;
var wordSize = 9;
var scrollPos=0;
var curIndex=0;
var length=10; 

function $(id){return document.getElementById(id);}

var posArray = [0,0,0,0,0,0,0,0,0,0,0]; //记录pos位置

var listArray=[//百事通专区
	{nums:"1",title:"匆匆那年",url:"../paihang/paihang1.htm"},
	{nums:"2",title:"超能陆战队（中文配音）",url:"../paihang/paihang2.htm"},
	{nums:"3",title:"大喜临门",url:"../paihang/paihang3.htm"},
	{nums:"4",title:"地牢围攻3",url:"../paihang/paihang4.htm"},
	{nums:"5",title:"第七谎言",url:"../paihang/paihang5.htm"},
	{nums:"6",title:"定制伴郎",url:"../paihang/paihang6.htm"},
	{nums:"7",title:"飓风营救3",url:"../paihang/paihang6.htm"},
	{nums:"8",title:"魔法黑森林",url:"../paihang/paihang7.htm"},
	{nums:"9",title:"魔法之家",url:"../paihang/paihang7.htm"},
	{nums:"10",title:"陌路惊笑",url:"../paihang/paihang10.htm"},
	{nums:"11",title:"奇鞋妙旅",url:"../paihang/paihang11.htm"},
	{nums:"12",title:"善意杀戮",url:"../paihang/paihang12.htm"},
	{nums:"13",title:"失孤",url:"../paihang/paihang13.htm"},
	{nums:"14",title:"十万伙急",url:"../paihang/paihang14.htm"},
	{nums:"15",title:"万物生长",url:"../paihang/paihang15.htm"},
	{nums:"16",title:"我是女王",url:"../paihang/paihang16.htm"},
	{nums:"17",title:"喜羊羊与灰太狼之羊年喜羊羊",url:"../paihang/paihang17.htm"},
	{nums:"18",title:"熊出没之雪岭熊风",url:"../paihang/paihang18.htm"},
	{nums:"19",title:"业内前五",url:"../paihang/paihang19.htm"},
	{nums:"20",title:"咱们结婚吧",url:"../paihang/paihang20.htm"},
	{nums:"21",title:"政治之爱",url:"../paihang/paihang21.htm"},
	{nums:"22",title:"左耳",url:"../paihang/paihang22.htm"},
	{nums:"23",title:"X战警",url:"../paihang/paihang23.htm"},
	{nums:"24",title:"X战警",url:"../paihang/paihang24.htm"},
	{nums:"25",title:"X战警",url:"../paihang/paihang25.htm"},
	{nums:"26",title:"X战警",url:"../paihang/paihang26.htm"},
	{nums:"27",title:"X战警",url:"../paihang/paihang27.htm"},
	{nums:"28",title:"X战警",url:"../paihang/paihang28.htm"},
	{nums:"29",title:"X战警",url:"../paihang/paihang29.htm"},
	{nums:"30",title:"X战警",url:"../paihang/paihang30.htm"}
//	{nums:"31",title:"最后一页了",url:"../paihang/paihang31.htm"}
];
function menuFocus(__num){
	$("menu"+menusPos).src = "../img/tm.gif";
	menusPos+=__num;
	if(menusPos<0)menusPos=2-1;
	else if(menusPos>2-1)menusPos=0;
	$("menu"+menusPos).src = "../img/homeFocus"+menusPos+".png";
}

function showList(){
	listPos = posArray[menuPos];
	var position = (parseInt((listPos+listSize)/listSize)-1)*listSize; //当前页的第一个	
	for(i=0; i<listSize; i++){
		if(position+i<listArray.length){
			$("zoneImg"+i).style.backgroundImage =  "url('../baiShiTong/"+(position+i)+".png')";
			$("zoneTxt"+i).innerHTML = listArray[position+i].title.slice(0,wordSize);
		}
		else {
			$("zoneImg"+i).style.backgroundImage = "url('../zone/99.png')";
			$("zoneTxt"+i).innerHTML = "";
		}
	}
	pageNum();
}

function listFocus(__num){
	listPos = posArray[menuPos];
	var currPage = parseInt((listPos+listSize)/listSize);//当前第几页	
	$("zoneTxt"+listPos%listSize).innerHTML = listArray[listPos].title.slice(0,wordSize);
	$("zoneTxt"+listPos%listSize).style.color = "#ffffff";
	$("zoneFocus"+listPos%listSize).style.backgroundImage = "url()";
	
	var tempPos = listPos;
	listPos+=__num;

	if(listPos<0){ //焦点定位到当前页第一个
	   listPos=10*(currPage-1)
	}
			
	else if(listPos>listArray.length-1)
		{
		listPos = tempPos;
		listFocus(0);
		return;
		}
	//如果翻了页，条目重新输出
	if(parseInt((listPos+listSize)/listSize)!=parseInt((tempPos+listSize)/listSize))
	{
		if(__num<0)
		{showList();
		}
		else{
			listPos = tempPos;
			listFocus(0);
			return;
		     }
	}
	
	$("zoneFocus"+listPos%listSize).style.backgroundImage = "url(../img/zoneFocus.png)";
	$("zoneTxt"+listPos%listSize).style.color = "#ffcc00";
	
	if(listArray[listPos].title.length>wordSize)
	{
		$("zoneTxt"+listPos%listSize).innerHTML = '<marquee direction="left" width="88%" scrollamonut="15" scrolldelay="100">'+listArray[listPos].title +'</marquee>';
	}
	posArray[menuPos] = listPos;
}

function pageUp(){
	listPos-=listSize;
	if(listPos<0){
		listPos+=listSize;	
	}
	posArray[menuPos] = listPos;
	showList();
}

function pageDown(){
	listPos+=listSize;
		if(listPos>listArray.length-1){
		if(parseInt(listPos/listSize)!=parseInt((listArray.length-1+listSize)/listSize))listPos = listArray.length-1;
		else listPos-=listSize;
	}
	posArray[menuPos] = listPos;
	showList();
}

function pagelast(){
	listPos = (parseInt((listPos+listSize)/listSize)-1)*listSize+listSize-1;//当前页的第一个	
	if(listPos>listArray.length-1)listPos=listArray.length-1;
}

//页码
function pageNum(){
	listPos = posArray[menuPos];
	var currPage = parseInt((listPos+listSize)/listSize);//当前第几页
	var allPage = parseInt((listArray.length-1+listSize)/listSize);//总共多少页
	$("page").innerHTML = "第"+currPage+"页"+"/"+"共"+allPage+"页"; 
}

document.onsystemevent = grabEvent;
document.onkeypress = grabEvent;
document.onirkeypress=grabEvent;
function grabEvent(){
	listPos = posArray[menuPos];
	var currPage = parseInt((listPos+listSize)/listSize);//当前第几页
	var allPage = parseInt((listArray.length-1+listSize)/listSize);//总共多少页	
	var key_code = event.which;
//	alert(key_code);
	switch(key_code){
		case 1://up
		if(area==0){
			if(listPos-10*(currPage-1)>4){//焦点在下
		listFocus(-5);				
		   }
		 }
		 
	    else if(area==1){
	    area=0;
	   	$("pdown").style.backgroundImage = "url(../img/pdown0.png)";
        $("zoneFocus"+listPos%listSize).style.backgroundImage = "url(../img/zoneFocus.png)";			 
		}
		
		else if(area==2){
		area=0;
	   	$("pup").style.backgroundImage = "url(../img/pup0.png)";
        $("zoneFocus"+listPos%listSize).style.backgroundImage = "url(../img/zoneFocus.png)";						
		}

		return 0;
		break;	

		case 2://down
		  if(area==0 && (listPos-10*(currPage-1))<5 && (listPos+5) < listArray.length){//焦点在上可下移
			 listFocus(5);
		  }
		 else if(area==0 && (listPos-10*(currPage-1))<5 && (listPos+6) > listArray.length && currPage == allPage){//焦点在上,不可下移,最后一页
			  area=2;
			  $("pup").style.backgroundImage = "url(../img/pup1.png)";
			  $("zoneFocus"+listPos%listSize).style.backgroundImage = "url()";			  
		   }
		  else if(area==0 && (listPos-10*(currPage-1))<5 && (listPos+6) > listArray.length && currPage < allPage){//非最后一页
			  area=1;
			  $("pdown").style.backgroundImage = "url(../img/pdown1.png)";
			  $("zoneFocus"+listPos%listSize).style.backgroundImage = "url()";			  
			  }
		  else if(area==0 && (listPos-10*(currPage-1)) > 4 && currPage==allPage){//焦点在下,最后一页
			  area=2;
			  $("pup").style.backgroundImage = "url(../img/pup1.png)";
			  $("zoneFocus"+listPos%listSize).style.backgroundImage = "url()";			  
		   }
		  else if(area==0 && (listPos-10*(currPage-1)) > 4 && currPage < allPage){//焦点在下,非最后一页{
			  area=1;
			  $("pdown").style.backgroundImage = "url(../img/pdown1.png)";
			  $("zoneFocus"+listPos%listSize).style.backgroundImage = "url()";			
		   }
		   
			return 0;
			break;	
        
		case 3://left
			if(area==0){
				listFocus(-1);
			}
			
			else if(area==1 && currPage<allPage && currPage>1)
			    {
			area=2;
			$("pup").style.backgroundImage = "url(../img/pup1.png)";	
			$("pdown").style.backgroundImage = "url(../img/pdown0.png)";					  
			    }
			return 0;
			break; 
					  				
		case 4: //right
			if(area==0 && listPos<listArray.length-1){
				listFocus(1);
			}
			
			else if(area==2 && currPage<allPage)
			{
			    area=1;
				$("pdown").style.backgroundImage = "url(../img/pdown1.png)";
				$("pup").style.backgroundImage = "url(../img/pup0.png)";				
			}
			return 0;
			break;	
			
		case 373://P+下一页
			if(area==0 && currPage==1){
			 $("pup").style.backgroundImage = "url(../img/pup0.png)";	       
			}else if(currPage==allPage-1){
			 $("pdown").style.backgroundImage = "url()";
			}
			  					
		    if(area==0 && currPage<allPage){
			pageDown();
			listFocus(-100);				
			}
			
		    return 0;
			break;
			
		case 372://P-上一页
			if(area==0 && currPage==2){
			  $("pup").style.backgroundImage = "url()";
			  }else if(currPage==allPage){
			  $("pdown").style.backgroundImage = "url(../img/pdown0.png)";				  
			}
					
			if(area==0 && currPage>1){
			pageUp();
			listFocus(-100);
			}
			return 0;
			break;	
						
		case 13: //enter
			doSelect();
		    return 0;
			break;

		case 340: //back
			history.go(-1);
			break;	
			
		case 339://exit
			window.close();
			return 0;
			break;
	}
}

function doSelect(){
	listPos = posArray[menuPos];
	var currPage = parseInt((listPos+listSize)/listSize);//当前第几页
	var allPage = parseInt((listArray.length-1+listSize)/listSize);//总共多少页		
	if(area==0)	{
		location.href = listArray[listPos].url;
	}
	
	else if(area==1){
		pageDown();
		listFocus(-100);
		
	    if(currPage==1){
		 $("pup").style.backgroundImage = "url(../img/pup0.png)";	       
		}
		
       else if(currPage==allPage-1){
		area=2;		
        $("pdown").style.backgroundImage = "url()";
        $("pup").style.backgroundImage = "url(../img/pup1.png)";	
		}
				
	}
	
	else if(area==2){
    	pageUp();
		listFocus(-100);
				
		if(currPage==2){
		area=1;	
	    $("pup").style.backgroundImage = "url()";
		$("pdown").style.backgroundImage = "url(../img/pdown1.png)";
		}
		
		if(currPage==allPage){
		$("pdown").style.backgroundImage = "url(../img/pdown0.png)";
		}
	}
}

function init(){
	showList();
}
</script>

</head>
<body topmargin="0" leftmargin="0" style="background:url(../img/index_baiShiTong.png)" onload="init();">
 <div style="position:absolute; left: 100px; top: 120px; width:1080px; height:524px"> 
    <table  width="1080" border="0" cellpadding="0" cellspacing="0" >
			<tr>
				<td id="zoneImg0" width="200" height="222"></td>
				<td width="20" height="222"></td>
				<td id="zoneImg1" width="200" height="222"></td>
			    <td width="20" height="222"></td>
				<td id="zoneImg2" width="200" height="222"></td>
			    <td width="20" height="222"></td>
				<td id="zoneImg3" width="200" height="222"></td>
				<td width="20" height="222"></td>
				<td id="zoneImg4" width="200" height="222"></td>
			</tr>
			<tr>
				<td id="zoneTxt0" width="200" height="30" >&nbsp;</td>
				<td width="20" height="30"></td>
				<td id="zoneTxt1" width="200" height="30">&nbsp;</td>
			    <td  width="20" height="30"></td>
				<td id="zoneTxt2" width="200" height="30">&nbsp;</td>
			    <td width="20" height="30"></td>
				<td id="zoneTxt3" width="200" height="30">&nbsp;</td>
				<td width="20" height="30"></td>
				<td id="zoneTxt4" width="200" height="30">&nbsp;</td>
			</tr>
			<tr>
				<td width="200" height="20"></td>
				<td height="20"></td>
				<td width="200" height="20"></td>
			    <td height="20"></td>
				<td width="200" height="20"></td>
			    <td height="20"></td>
				<td width="200" height="20"></td>
				<td height="20"></td>
				<td width="200" height="20"></td>
			</tr>
			<tr>
				<td id="zoneImg5" width="200" height="222"></td>
				<td width="20" height="222"></td>
				<td id="zoneImg6" width="200" height="222"></td>
			    <td width="20" height="222"></td>
				<td id="zoneImg7" width="200" height="222"></td>
			    <td width="20" height="222"></td>
				<td id="zoneImg8" width="200" height="222"></td>
				<td width="20" height="222"></td>
				<td id="zoneImg9" width="200" height="222"></td>
			</tr>
			<tr>
				<td id="zoneTxt5" width="200" height="30">&nbsp;</td>
				<td width="16" height="30"></td>
				<td id="zoneTxt6" width="200" height="30">&nbsp;</td>
			    <td width="16" height="30"></td>
				<td id="zoneTxt7" width="200" height="30">&nbsp;</td>
			    <td width="15" height="30"></td>
				<td id="zoneTxt8" width="200" height="30">&nbsp;</td>
				<td width="16" height="30"></td>
				<td id="zoneTxt9" width="200" height="30">&nbsp;</td>
			</tr>
  </table>

</div>
 <div style="position:absolute; left: 97px; top: 117px; width:1086px; height:536px"> 
   <table  width="1086" border="0" cellpadding="0" cellspacing="0" >
			<tr>
				<td id="zoneFocus0" width="206" height="258"style="background:url('../img/zoneFocus.png') no-repeat"></td>
				<td width="14" height="258"></td>
				<td id="zoneFocus1" width="206" height="258"style="background:url() no-repeat"></td>
			    <td width="14" height="258"></td>
				<td id="zoneFocus2" width="206" height="258"style="background:url() no-repeat"></td>
			    <td width="14" height="258"></td>
				<td id="zoneFocus3" width="206" height="258"style="background:url() no-repeat"></td>
				<td width="14" height="258"></td>
				<td id="zoneFocus4" width="206" height="258"style="background:url() no-repeat"></td>
			</tr>
			<tr>
				<td width="206" height="14"></td>
				<td height="14"></td>
				<td width="206" height="14"></td>
			    <td height="14"></td>
				<td width="206" height="14"></td>
			    <td height="14"></td>
				<td width="206" height="14"></td>
				<td height="14"></td>
				<td width="206" height="14"></td>
			</tr>
			<tr>
				<td id="zoneFocus5" width="206" height="258"style="background:url() no-repeat"></td>
				<td width="14" height="258"></td>
				<td id="zoneFocus6" width="206" height="258"style="background:url() no-repeat"></td>
			    <td width="14" height="258"></td>
				<td id="zoneFocus7" width="206" height="258"style="background:url() no-repeat"></td>
			    <td width="14" height="258"></td>
				<td id="zoneFocus8" width="206" height="258"style="background:url() no-repeat"></td>
				<td width="14" height="258"></td>
				<td id="zoneFocus9" width="206" height="258"style="background:url() no-repeat"></td>
			</tr>

  </table>

</div>

<div id="page" style="position: absolute; left: 714px; top: 655px; width: 185px; height: 40px; text-align: center; line-height: 40px; color: #000000; font-size: 28px;">1/3</div>
<div id="pup" style="z-index: 100; position: absolute; left: 904px; top: 658px; width: 130px; height: 40px; line-height: 36px; background: url() no-repeat"></div>
<div id="pdown" style="z-index: 100; position: absolute; left: 1048px; top: 655px; width: 130px; height: 40px; line-height: 36px; background: url('../img/pdown0.png') no-repeat""></div>

</body>
</html>